# 👤 用户使用手册

## 📚 目录

1. [快速开始](#快速开始)
2. [界面介绍](#界面介绍)
3. [功能详解](#功能详解)
4. [最佳实践](#最佳实践)
5. [常见问题](#常见问题)
6. [技巧提示](#技巧提示)

---

## 快速开始

### 第一步：获取授权码

1. 打开浏览器，访问 [163邮箱](https://mail.163.com)
2. 登录你的邮箱
3. 点击右上角「设置」→「POP3/SMTP/IMAP」
4. 找到「IMAP/SMTP服务」，点击「开启」
5. 按照提示完成验证（可能需要发送短信）
6. 记录生成的**授权码**（一串随机字符）

**⚠️ 重要提示**：
- 授权码 ≠ 登录密码
- 授权码只显示一次，请妥善保存
- 不要泄露授权码给他人

### 第二步：启动程序

#### 方法 A：使用启动脚本（推荐）

```bash
cd /Users/code/Eason
./run.sh
```

#### 方法 B：直接运行

```bash
python3 email_assistant_gui.py
```

### 第三步：配置账号

在打开的窗口中：
1. 在「邮箱账号」输入框填入：`your_name@163.com`
2. 在「授权码」输入框粘贴刚才获取的授权码
3. 配置会自动保存，下次无需重复输入

---

## 界面介绍

### 主界面布局

```
┌─────────────────────────────────────────┐
│  📮 账号配置                             │
│  ┌─────────────────────────────────┐   │
│  │ 邮箱: [your_email@163.com    ] │   │
│  │ 授权码: [****************    ] │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│  📥 采集联系人  │  📤 批量发送         │
│  ┌─────────────────────────────────┐   │
│  │  [功能区域]                      │   │
│  │                                  │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│  📊 运行状态                             │
│  ▓▓▓▓▓▓▓▓▓▓▓▓░░░░░░░ 60%             │
│  ┌─────────────────────────────────┐   │
│  │ [运行日志]                       │   │
│  └─────────────────────────────────┘   │
└─────────────────────────────────────────┘
```

### 区域说明

1. **账号配置区**（顶部）
   - 一次配置，永久记忆
   - 授权码为密码形式显示

2. **功能选项卡**（中部）
   - Tab 1：采集联系人
   - Tab 2：批量发送

3. **运行状态区**（底部）
   - 进度条：显示任务进度
   - 日志窗口：实时显示运行信息

---

## 功能详解

### 功能一：采集联系人

#### 使用场景

- 从收件箱中提取所有发件人邮箱
- 快速建立联系人数据库
- 去重并导出为文件

#### 操作步骤

1. **配置账号**
   - 确保已填写邮箱和授权码

2. **设置采集数量**
   ```
   采集数量: [200] 封
   ```
   - 默认：200 封邮件
   - 范围：10-5000 封
   - 建议：首次使用 100-200 封测试

3. **开始采集**
   - 点击「🚀 开始采集」按钮
   - 观察日志窗口实时进度：
     ```
     [10:30:15] 🔌 正在连接 IMAP 服务器...
     [10:30:17] 🔐 正在登录...
     [10:30:18] 📬 正在选择收件箱...
     [10:30:19] 📊 收件箱共有 850 封邮件，准备采集最近 200 封...
     [10:30:25] 📧 已扫描 20 个邮箱地址...
     [10:30:45] ✅ 采集完成！原始: 200, 去重后: 178
     ```

4. **查看结果**
   - 采集完成后，邮箱地址显示在预览框中
   - 每行一个邮箱地址

5. **导出联系人**
   - 点击「💾 导出联系人」
   - 选择保存位置和格式：
     - `contacts.txt` - 纯文本格式
     - `contacts.csv` - Excel 可打开的格式

#### 功能特点

- ✅ 自动去重：相同邮箱只保留一个
- ✅ 保持顺序：按时间倒序（最新的在前）
- ✅ 可随时停止：点击「⏹ 停止」按钮
- ✅ 实时反馈：日志显示详细进度

#### 注意事项

- ⚠️ 采集时间取决于邮箱数量（通常 1-3 分钟）
- ⚠️ 网络不稳定可能导致中断，重新开始即可
- ⚠️ 采集的是「发件人」地址，不是收件人

---

### 功能二：批量发送

#### 使用场景

- 批量发送通知邮件
- 发送活动邀请
- 群发产品更新信息

#### 操作步骤

1. **准备联系人列表**

   **方式 A：使用采集的联系人**
   - 在「采集联系人」标签页导出文件
   - 在「批量发送」标签页加载该文件

   **方式 B：手动创建文件**
   
   创建 `my_contacts.txt`：
   ```
   user1@example.com
   user2@example.com
   user3@example.com
   ```
   
   或 `my_contacts.csv`：
   ```csv
   联系人邮箱
   user1@example.com
   user2@example.com
   ```

2. **加载联系人**
   - 点击「📂 浏览...」
   - 选择联系人文件
   - 路径显示在输入框中

3. **编写邮件内容**

   ```
   📧 邮件主题: [重要通知]
   
   📝 邮件正文:
   尊敬的用户，
   
   您好！这是一封测试邮件。
   
   感谢您的支持！
   
   此致
   敬礼
   ```

4. **添加附件（可选）**
   - 点击「📎 添加附件」
   - 支持格式：
     - 图片：`.jpg`, `.jpeg`, `.png`, `.gif`
     - 文档：`.pdf`
   - 大小限制：建议 < 10MB

5. **配置发送策略**

   ```
   ⚙️ 发送策略:
   批次大小: [10] 封/批
   间隔时间: [20] 秒
   ```

   **参数说明**：
   - **批次大小**：每批发送多少封邮件
     - 建议值：5-15 封
     - 过大可能被识别为垃圾邮件
   
   - **间隔时间**：批次之间的等待秒数
     - 建议值：20-60 秒
     - 时间越长越安全，但发送越慢

6. **开始发送**
   - 点击「🚀 开始发送」
   - 观察日志和进度条：
     ```
     [10:45:00] 📋 加载了 30 个收件人
     [10:45:01] 🚀 准备开始发送邮件...
     [10:45:02] 📦 批次 1: 准备发送 10 封邮件...
     [10:45:03] 🔐 批次 1 SMTP 登录成功
     [10:45:04] ✅ [1/30] user1@example.com
     [10:45:05] ✅ [2/30] user2@example.com
     ...
     [10:45:15] ⏸️ 批次完成，等待 20 秒后继续...
     [10:45:35] 📦 批次 2: 准备发送 10 封邮件...
     ```

7. **监控进度**
   - 进度条：显示完成百分比
   - 日志窗口：显示每封邮件状态
     - ✅ 成功
     - ❌ 失败（会显示原因）

8. **完成发送**
   - 任务完成后弹出统计对话框：
     ```
     ✅ 发送完成
     
     ✅ 成功: 28
     ❌ 失败: 2
     📊 总计: 30
     ```

#### 功能特点

- ✅ 批次发送：避免被封禁
- ✅ 断线重连：网络中断自动重试
- ✅ 进度保存：可随时停止
- ✅ 详细日志：每封邮件状态清晰可见
- ✅ 多种附件：支持图片和 PDF

#### 安全建议

| 场景 | 建议配置 |
|------|---------|
| 少量发送（<50） | 批次: 10, 间隔: 20秒 |
| 中量发送（50-200） | 批次: 10, 间隔: 30秒 |
| 大量发送（>200） | 批次: 5, 间隔: 60秒 |

---

## 最佳实践

### 采集联系人

✅ **推荐做法**

1. 首次使用先采集 100 封测试
2. 定期采集，保持联系人列表更新
3. 采集后立即导出备份
4. 使用 CSV 格式方便 Excel 处理

❌ **不推荐做法**

1. 一次采集过多（>1000）可能很慢
2. 不导出就关闭程序（数据会丢失）

### 批量发送

✅ **推荐做法**

1. **先小批量测试**
   - 先选 2-3 个自己的邮箱测试
   - 确认格式和内容无误后再批量发

2. **合理设置间隔**
   - 不要心急，间隔太短容易被限制
   - 宁可慢一点，也要确保成功率

3. **邮件内容优化**
   - 主题简洁明了
   - 正文避免全大写
   - 不要包含大量链接
   - 适当添加图片让邮件更美观

4. **时间选择**
   - 避开高峰期（上午 9-11 点）
   - 分多次发送大量邮件

5. **监控日志**
   - 随时观察日志窗口
   - 发现异常立即停止

❌ **不推荐做法**

1. 批次过大（>20 封）
2. 间隔过短（<15 秒）
3. 邮件内容像广告
4. 频繁给同一人发送
5. 使用敏感词汇

---

## 常见问题

### Q1: 为什么连接失败？

**可能原因**：
1. ❌ 授权码错误
2. ❌ 未开启 IMAP/SMTP 服务
3. ❌ 网络连接问题
4. ❌ 邮箱被临时限制

**解决方法**：
1. 重新获取授权码
2. 检查邮箱设置，确保服务已开启
3. 检查网络连接
4. 等待 1-2 小时后重试

### Q2: 发送失败怎么办？

**常见错误及解决**：

| 错误提示 | 原因 | 解决方法 |
|---------|------|---------|
| Authentication failed | 授权码错误 | 重新输入授权码 |
| Connection refused | 网络问题 | 检查网络连接 |
| Mailbox unavailable | 收件人不存在 | 检查邮箱地址 |
| Message too large | 附件过大 | 压缩附件或分批发送 |
| Spam detected | 被识别为垃圾邮件 | 修改内容，增加间隔 |

### Q3: 如何提高发送成功率？

**技巧**：
1. ✅ 使用真实的主题和内容
2. ✅ 避免敏感词汇（免费、中奖、点击等）
3. ✅ 适当增加批次间隔
4. ✅ 不要频繁发送
5. ✅ 邮件内容图文并茂
6. ✅ 让收件人加入白名单

### Q4: 可以同时运行多个任务吗？

**回答**：不建议

- ❌ 同一账号不能同时连接多次
- ❌ 会导致连接冲突
- ✅ 等待当前任务完成后再开始新任务

### Q5: 配置会保存吗？

**回答**：会自动保存

保存的信息：
- ✅ 邮箱账号
- ✅ 授权码
- ✅ 上次使用的文件路径
- ✅ 上次的主题和正文
- ✅ 上次的附件路径

下次打开软件自动填充，无需重复输入。

---

## 技巧提示

### 💡 技巧 1：使用变量替换（计划功能）

当前版本尚不支持，未来可能支持：

```
尊敬的 {姓名}，

您的订单 {订单号} 已发货...
```

**当前替代方案**：
- 使用 Excel 的「邮件合并」功能
- 或手动编辑每封邮件

### 💡 技巧 2：分类管理联系人

建议创建多个联系人文件：

```
contacts/
├── customers.txt      # 客户
├── partners.txt       # 合作伙伴
├── team.txt          # 团队成员
└── test.txt          # 测试邮箱
```

### 💡 技巧 3：查看发送历史

当前版本日志仅在软件运行时显示。

**保存日志的方法**：
1. 复制日志窗口内容
2. 粘贴到文本文件保存
3. 或截图保存

### 💡 技巧 4：快捷键（计划功能）

未来可能支持的快捷键：
- `Cmd + N`: 开始新任务
- `Cmd + S`: 保存配置
- `Cmd + Q`: 退出程序

### 💡 技巧 5：定时发送（计划功能）

当前需要手动点击发送。

**替代方案**：
- 设置好后，在指定时间点击发送
- 或使用 macOS 的自动化工具

---

## 🆘 获取帮助

如果遇到问题：

1. 📖 查看 [README.md](README.md)
2. 📦 查看 [INSTALL.md](INSTALL.md)
3. 🔍 查看错误日志寻找线索
4. 💬 联系开发者寻求帮助

---

**祝使用愉快！ 📧✨**
